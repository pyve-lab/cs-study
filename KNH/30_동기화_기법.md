# 동기화 기법 (Synchronization Mechanisms)

## 1. 동기화 기법 개요

- 동기화 기법은
    - **상호 배제**
    - **실행 순서 제어**
        
        를 구현하기 위한 도구
        
- 「혼자 공부하는 컴퓨터 구조 + 운영체제」에서는
    
    다음 세 가지를 핵심 동기화 기법으로 설명한다.
    
- **뮤텍스 락 (Mutex Lock)**
- **세마포 (Semaphore)**
- **모니터 (Monitor)**

---

## 2. 뮤텍스 락 (Mutex Lock)

### 2-1. 뮤텍스 락이란?

- **상호 배제를 위한 동기화 도구**
- 임계 구역에 **한 번에 하나의 프로세스만 접근**하도록 함
- 자물쇠 역할을 함

👉 책에서는 **탈의실 사물함**에 비유

(사물함을 사용 중이면 다른 사람은 기다려야 함)

---

### 2-2. 뮤텍스 락의 단순한 형태

- 전역 변수 **하나**
- 함수 **두 개**

### 구성 요소

- `lock`
    - 프로세스들이 공유하는 전역 변수
    - 임계 구역이 잠겨 있는지 여부 표시
- `acquire()`
    - 임계 구역에 진입하기 전에 호출
    - 잠금 역할
- `release()`
    - 임계 구역에서 나올 때 호출
    - 잠금 해제 역할

---

### 2-3. acquire 함수의 역할

- 프로세스가 임계 구역에 들어가기 전 호출
- 동작 방식
    1. 임계 구역이 잠겨 있다면
        
        → `lock == false`가 될 때까지 반복 확인
        
    2. 임계 구역이 열려 있다면
        
        → `lock = true`로 변경하고 진입
        

---

### 2-4. release 함수의 역할

- 임계 구역 작업이 끝난 뒤 호출
- `lock = false`로 변경
- 다른 프로세스가 임계 구역에 진입 가능

---

### 2-5. 바쁜 대기 (Busy Waiting)

- `acquire()`에서
    - 임계 구역이 열렸는지 **무한 반복 확인**
- 탈의실 문이 열렸는지 계속 확인하는 것과 같음

👉 문제점:

- **CPU 사이클 낭비 발생**

---

## 3. 세마포 (Semaphore)

### 3-1. 세마포란?

- **뮤텍스 락을 일반화한 동기화 도구**
- **공유 자원이 여러 개** 있는 경우에도 사용 가능
- 책에서는 **카운팅 세마포**를 중심으로 설명

---

### 3-2. 세마포의 개념적 동작

- 임계 구역 앞에서:
    - “기다려” 신호 → 대기
    - “가도 좋아” 신호 → 진입

---

### 3-3. 세마포의 단순한 형태

- 전역 변수 **하나**
- 함수 **두 개**

### 구성 요소

- `S`
    - 사용 가능한 공유 자원의 개수
    - 임계 구역에 동시에 진입 가능한 프로세스 수
- `wait()`
    - 임계 구역에 들어가도 되는지 확인
    - 불가능하면 대기
- `signal()`
    - 대기 중인 프로세스에게
    - 이제 들어와도 된다고 알림

---

### 3-4. 세마포에서도 발생하는 문제

- `wait()`에서도
    - 자원이 생겼는지 **계속 확인**
- 즉, **바쁜 대기 발생**

👉 역시 CPU 사이클 낭비

---

### 3-5. 바쁜 대기의 해결 방법 (책 기준)

운영체제는 다음 방식으로 바쁜 대기를 해결한다.

1. **자원이 없을 경우**
    - 해당 프로세스를 **대기 상태**로 전환
    - PCB를 **대기 큐**에 삽입
2. **자원이 생길 경우**
    - 대기 큐의 프로세스를 꺼내
    - **준비 상태**로 전환
    - PCB를 준비 큐에 삽입

---

### 3-6. 세마포를 이용한 실행 순서 제어

- 세마포 변수 `S`를 **0으로 초기화**
- 실행 순서 제어 방법:
    - **먼저 실행할 프로세스 뒤에 `signal()`**
    - **나중에 실행할 프로세스 앞에 `wait()`**

👉 실행 순서를 강제로 보장 가능

---

## 4. 모니터 (Monitor)

### 4-1. 모니터가 등장한 이유

- 뮤텍스 락과 세마포는:
    - 순서를 헷갈리기 쉬움
    - 함수 호출을 빠뜨리면 오류 발생
    - 디버깅이 어려움

👉 이러한 문제를 해결하기 위해 **모니터 등장**

---

### 4-2. 모니터란?

- **개발자가 사용하기 편한 고수준 동기화 도구**
- 다음 두 가지를 **모두 제공**
    - 상호 배제를 위한 동기화
    - 실행 순서 제어를 위한 동기화

👉 책에서는

**Java가 모니터를 활용하는 대표적인 예**로 언급

---

## 5. 모니터의 상호 배제 동기화

### 동작 방식

- 공유 자원에 접근하려는 프로세스는
    - **인터페이스를 위한 큐**에 삽입
- 큐에 들어온 순서대로
    - **한 번에 하나의 프로세스만**
    - 공유 자원 사용

👉 모니터 내부에는

**동시에 하나의 프로세스만 존재 가능**

---

## 6. 모니터의 실행 순서 제어 동기화

### 6-1. 조건 변수 (Condition Variable)

- 프로세스(또는 스레드)의
    - **실행 순서를 제어하기 위한 특별한 변수**

---

### 6-2. 조건 변수 함수

- `조건변수.wait()`
    - 프로세스를 **대기 상태로 전환**
    - 조건 변수에 대한 큐에 삽입
- `조건변수.signal()`
    - 대기 중인 프로세스 중 하나를 깨움

---

### 6-3. 실행 재개 규칙 (책에서 강조)

- `wait()`를 호출한 프로세스는
    - `signal()`을 호출한 프로세스가
    - **모니터를 떠난 뒤에 실행 재개**
- 실행 순서:
    1. `signal()`을 호출한 프로세스 실행
    2. 모니터 종료
    3. `wait()`했던 프로세스 실행 재개

---

## 7. 핵심 요약

- 뮤텍스 락
    - 상호 배제 전용
    - 구조 단순하지만 바쁜 대기 발생
- 세마포
    - 여러 자원 관리 가능
    - 실행 순서 제어 가능
    - 바쁜 대기 → 대기 큐로 해결
- 모니터
    - 고수준 동기화 도구
    - 상호 배제 + 실행 순서 제어 모두 제공
    - 사용하기 가장 안전하고 편리

---

## 한 줄 정리

> ❝ 동기화 기법은
> 
> 
> 공유 자원을 안전하게 사용하고
> 
> 실행 순서를 보장하기 위한 운영체제의 도구이다 ❞
>