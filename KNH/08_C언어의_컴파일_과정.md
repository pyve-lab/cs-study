# 8강 C 언어의 컴파일 과정

---

## 1. C 프로그램이 실행되기까지의 전체 흐름

C 언어로 작성한 프로그램은

작성 즉시 실행되는 것이 아니라

여러 단계를 거쳐 **기계어로 변환된 후 실행**된다.

전체 흐름은 다음과 같다.

**소스 코드 → 전처리 → 컴파일 → 어셈블 → 링크 → 실행 파일**

---

## 2. 소스 코드 (Source Code)

- 사람이 작성한 C 언어 코드
- 확장자: `.c`
- 아직 컴퓨터가 이해할 수 없는 상태

예시:

#include <stdio.h>

int main() {
printf("Hello, World!");
return 0;
}

---

## 3. 전처리 (Preprocessing)

전처리는 **컴파일 전에 소스 코드를 가공하는 단계**이다.

### 주요 작업

- `#include`
→ 헤더 파일 내용 삽입
- `#define`
→ 매크로 치환
- 주석 제거
- 조건부 컴파일 처리 (`#if`, `#ifdef` 등)

### 결과

- 전처리된 소스 코드 생성
- 확장자: 보통 `.i`

> 전처리 단계에서는 **문법 검사나 기계어 변환은 수행하지 않는다.**
> 

---

## 4. 컴파일 (Compilation)

컴파일 단계에서는 전처리된 소스 코드를 **어셈블리어로 변환**한다.

### 주요 작업

- 문법 검사
- 의미 분석
- 최적화
- 중간 코드 생성

### 결과

- 어셈블리 코드 생성
- 확장자: `.s`

> 이 단계에서 **문법 오류(Syntax Error)** 가 발생하면 컴파일이 중단된다.
> 

---

## 5. 어셈블 (Assembly)

어셈블 단계에서는 어셈블리어를 **기계어로 변환**한다.

### 주요 작업

- 어셈블리어 → 기계어
- CPU가 직접 실행할 수 있는 코드 생성

### 결과

- 목적 파일(Object File) 생성
- 확장자: `.o`

> 목적 파일은 아직 단독으로 실행할 수 없다.
> 

---

## 6. 링크 (Linking)

링크 단계에서는 여러 목적 파일과 라이브러리를 하나로 결합한다.

### 주요 작업

- 여러 `.o` 파일 결합
- 표준 라이브러리 함수 연결 (`printf` 등)
- 함수 및 변수 주소 확정

### 결과

- 실행 파일 생성
- 확장자: (리눅스 기준 없음, 윈도우 기준 `.exe`)

> 이 단계에서 **정의되지 않은 참조 오류(Link Error)** 가 발생할 수 있다.
> 

---

## 7. 실행 (Execution)

- 생성된 실행 파일을 운영체제가 로드
- 메모리에 적재
- CPU가 명령어를 하나씩 실행 `./a.out`

---

## 8. 컴파일 오류와 링크 오류의 차이

| 구분 | 발생 단계 | 원인 |
| --- | --- | --- |
| 컴파일 오류 | 컴파일 | 문법 오류, 타입 오류 |
| 링크 오류 | 링크 | 함수/변수 정의 누락 |

---

## 9. GCC 기준 단계별 파일 생성 예시

gcc -E main.c   // 전처리

gcc -S main.c   // 컴파일

gcc -c main.c   // 어셈블

gcc main.c      // 링크 (실행 파일 생성)

---

## 10. 정리

- C 프로그램은 바로 실행되지 않는다
- 전처리 → 컴파일 → 어셈블 → 링크 과정을 거친다
- 컴파일 결과는 기계어가 아닌 목적 파일이다
- 실행 파일은 링크 단계에서 완성된다
- CPU는 최종적으로 기계어만 실행한다