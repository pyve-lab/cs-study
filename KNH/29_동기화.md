# 동기화(Synchronization)

## 1. 동기화의 의미

- **프로세스 동기화**란
    
    여러 프로세스(또는 스레드)가 **자원을 올바르게 공유하며 수행되도록 실행 시기를 맞추는 것**
    
- 동기화는 **자원의 일관성**과 **프로그램의 올바른 수행**을 위해 필요하다.

> ❝ 동기화란, 여러 실행 흐름이 서로 영향을 주지 않도록
> 
> 
> 수행 순서와 접근을 조절하는 것 ❞
> 

---

## 2. 동기화의 대상

- 실행의 **문맥(Context)** 을 가지는 모든 대상은 동기화의 대상
- 따라서:
    - 프로세스 ⭕
    - 스레드 ⭕

👉 **스레드도 독립적인 실행 흐름이기 때문에 동기화 대상**

---

## 3. 동기화의 두 가지 목적

프로세스 동기화는 크게 두 가지로 나뉜다.

### 3-1. 실행 순서 제어를 위한 동기화

- 여러 프로세스가 **정해진 순서대로 실행되도록 제어**
- 특정 조건이 만족되어야 다음 프로세스가 실행 가능

---

### 3-2. 상호 배제를 위한 동기화

- **동시에 접근해서는 안 되는 자원**에
    
    한 번에 하나의 프로세스만 접근하도록 제어
    

---

## 4. 실행 순서 제어를 위한 동기화

### (Reader-Writer Problem)

### 개념 설명

- **Writer 프로세스**
    - `Book.txt` 파일에 값을 저장
- **Reader 프로세스**
    - `Book.txt` 파일에 저장된 값을 읽음

---

### 문제 상황

- Reader와 Writer 프로세스가
    - 아무 순서 없이 실행되면 ❌
- Reader는
    - `Book.txt`에 값이 **존재한다는 조건이 만족되어야만 실행 가능**

👉 즉, **실행 순서가 중요**

---

### 핵심 포인트

- Writer → Reader 순서 보장 필요
- 실행 순서를 맞추지 않으면
    - 잘못된 값 읽기
    - 오류 발생

---

## 5. 상호 배제를 위한 동기화

### (Bank Account Problem)

### 개념 설명

- 공유 자원: **계좌 잔액**
- 초기 잔액: **10만 원**
- 프로세스 A: 2만 원 추가
- 프로세스 B: 5만 원 추가

---

### 동기화가 안 된 경우

1. 프로세스 A 실행 → 10만 원 읽음
2. 문맥 교환
3. 프로세스 B 실행 → 10만 원 읽음
4. 문맥 교환
5. A 결과 저장 → 12만 원
6. B 결과 저장 → 15만 원 ❌ (잘못된 결과)

👉 실제로는 **17만 원**이 되어야 함

---

### 핵심 원인

- 두 프로세스가
    - **동시에 공유 자원(잔액 변수)에 접근**
- 한 프로세스가 접근 중일 때
    - 다른 프로세스는 **기다려야 함**

---

## 6. Producer & Consumer Problem

### 개념 설명

- **Producer(생산자)**
    - 물건을 계속 생산
- **Consumer(소비자)**
    - 물건을 계속 소비
- **공유 자원**
    - 총합 변수, 버퍼 등

---

### 문제 원인

- 동기화가 되지 않으면
    - 동시에 접근해서는 안 되는 자원에
    - 여러 프로세스가 동시에 접근

👉 이로 인해 **잘못된 결과 발생**

> 책 예제 코드:
> 
> 
> https://github.com/kangtegong/self-learning-cs
> 

---

## 7. 공유 자원과 임계 구역

### 7-1. 공유 자원 (Shared Resource)

- 여러 프로세스 또는 스레드가 **공유하는 자원**

예:

- 전역 변수
- 파일
- 입출력 장치
- 보조기억장치

---

### 7-2. 임계 구역 (Critical Section)

- 공유 자원에 접근하는 코드 영역
- **동시에 실행되면 문제가 발생하는 영역**

예:

- 총합 변수 갱신 코드
- 계좌 잔액 변경 코드

---

### 7-3. 임계 구역의 특징

- 임계 구역에 진입한 프로세스가 있다면
    - 다른 프로세스는 **대기해야 함**
- 동시에 접근하면
    - 자원의 일관성 깨짐

👉 이를 **레이스 컨디션(Race Condition)** 이라고 한다.

---

## 8. 임계 구역 문제 해결을 위한 3가지 원칙

(상호 배제를 위한 동기화 조건)

운영체제가 임계 구역 문제를 해결하기 위해 지켜야 할 원칙은 다음 세 가지다.

---

### 8-1. 상호 배제 (Mutual Exclusion)

- 한 프로세스가 임계 구역에 진입했다면
- 다른 프로세스는 **진입할 수 없다**

---

### 8-2. 진행 (Progress)

- 임계 구역에 아무도 진입하지 않았다면
- 진입하고자 하는 프로세스는
    - **들어갈 수 있어야 한다**

---

### 8-3. 유한 대기 (Bounded Waiting)

- 임계 구역에 들어가고 싶어하는 프로세스는
- **언젠가는 반드시 진입할 수 있어야 한다**
- 무한정 대기 ❌

---

## 핵심 요약

- 동기화는 실행 순서와 자원 접근을 제어하는 것
- 동기화 목적:
    - 실행 순서 제어
    - 상호 배제
- 공유 자원 접근 시 임계 구역 문제 발생 가능
- 레이스 컨디션을 막기 위해 동기화 필요
- 운영체제는
    - 상호 배제
    - 진행
    - 유한 대기
        
        세 가지 원칙을 만족해야 함
        

---

## 한 줄 정리

> ❝ 동기화는
> 
> 
> 여러 실행 흐름이 공유 자원을 올바르게 사용하도록
> 
> 실행 시점과 접근을 조절하는 것이다 ❞
>