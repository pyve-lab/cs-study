~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~
11강. 명령어 사이클과 인터럽트
~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~*~

CPU는 메모리에 저장된 프로그램의 명령어와 데이터를 가져와 실행하며, 이 과정은 일정한 패턴과 주기를 가진다.

명령어 사이클
 : CPU가 메모리에 있는 프로그램을 처리하는 정해진 흐름 주기
 - 기본 단계
   - 인출 사이클 : 메모리에 저장된 값을 CPU 내부(레지스터 등)로 가져오는 작업
   - 실행 사이클 : 인출된 값을 실행하는 단계
   -> 일반적으로 일출 사이클과 실행 사이클을 반복하며 프로그림 처리

   근데 곧바로 실행할 수 없는 경우가 있는데,
   간접 주소 지정 방식은 오퍼랜드 필드에 유효 주소의 주소를 명시
   이 경우 명령어를 인출하여 CPU로 가져왔다 하더라도 바로 실행 사이클에 돌입할 수 없음!
   명령어를 실행하기 위해서 메모리 접근을 한 번 더 해야 하기 때문
   -> 이 단계를 !!!!!간접 사이클!!!!!

~*~*~*~*~*~*~*~
인터럽트
 : CPU가 정해진 흐름대로 명령어를 처리하고 있을 때, 정해진 흐름을 방해하거나 중단시키는 신호를 의미
 - 발생 시점 : 인터텁트 CPU가 주목해야 할 때나 얼른 처리해야 하는 작업이 생겼을 때 주로 발생

인터럽트의 종류 구분
 : 인터럽트는 크게 동기 인터럽트와 비동기 인터럽트로 나뉘며, 하드웨어 인터럽트(비동기 인터럽트) 중요
 - 동기 인터럽트 (예외, exception)
   : CPU가 예기치 못한 상황을 접했을 때 발생, CPU가 스스로 인지하고 실행을 중단하고 먼저 처리해야 한다고 판단하는 경우
  - 폴트
  - 트랩
  - 중단
  - 소프트웨어 인터럽트

 - 비동기 인터럽트 (하드웨어 인터럽트) (입출력장치에 의해)

하드웨어 인터럽트 처리 순서
 1. 입출력장치는 CPU에 인터럽트 요청 신호를 보냅니다.
 2.
 - 인터럽트 요청 신호
   : 입출력 장치 등 인터럽트를 보내는 주체가 CPU에게 인터럽트 요청 신호를 보냅니다.
 - 인터럽트 플래그
   - 인터럽트 받아들일 거야 말거야 근데 무조건은 아님 (정전아니 하드웨어 고정은 우선순위 높)
     - 막을 수 있는, 막을 수 없는
   :  CPU는 플래그 레지스터에 있는 인터럽트 플래그를 참조하여 현재 인터럽트를 받아들일 수 있는지 여부를 확인합니다.

 - 인터럽트 벡터

 - 인터럽트 서비스 루틴
   : 처리가 가능하다면, CPU는 지금까지 하던 작업을 잠시 백업하고, 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴(ISR)이라는 프로그램을 실행합니다




~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
마무리
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
8가지 키워드로 정리하는 핵심 포인트
- 프로그램 카운터는 메모리에서 가져올 명령어의 주소, 명령어 레지스터는 해석할 명령어를 저장합니다.
- 메모리 주소 레지스터는 메모리 주소, 메모리 버퍼 레지스터는 메모리와 주고받을 데이터를 저장합니다.
- 범용 레지스터는 데이터와 주소를 모두 저장하고, 플래그 레지스터는 연산 결과 혹은 CPU 상태에 대한 부가 정보를 저장합니다.
- 스택 포인터는 스택 최상단의 위치를 저장합니다.
- 베이스 레지스터에 저장된 주소는 기준 주소로서의 역할을 합니다.

확인문제
1. 현재 프로그램 카운터에 저장된 값이 아래와 같을 때 CPU가 다음으로 읽어 들일 메모리 주소는 몇 번지일까요?
   ::::::::: 답 2100 번지 :::::::::

2. 설명에 맞는 레지스터를 보기에서 찾아 빈칸을 채워 보세요.
   보기 프로그램 카운터, 명령어 레지스터, 플래그 레지스터, 범용 레지스터
   ① : 연산 결과 혹은 CPU 상태에 부가 정보를 저장하는 레지스터
   ② : 메모리에서 가져올 명령어의 주소를 저장하는 레지스터
   ③ : 데이터와 주소를 모두 저장할 수 있는 레지스터
   ④ : 해석할 명령어를 저장하는 레지스터
   ::::::::: 답 ① 플래그 레지스터, ② 프로그램 카운터, ③ 범용 레지스터, ④ 명령어 레지스터 :::::::::

3. 현재 아래와 같은 스택을 가리키는 스택 포인터가 있다고 가정해 봅시다.
   이 스택에서 데이터를 두 번 빼내게 되었을 때 스택 포인터에 저장되는 주소는 몇 번지일까요?
   ::::::::: 답 4번지 :::::::::

4. 레지스터에 대한 설명으로 옳은 것을 고르세요.
   ① 산술 연산과 논리 연산을 수행하는 부품입니다.
   ② 제어 신호를 발생시킵니다.
   ③ 명령어를 해석합니다.
   ④ CPU 내에 있는 작은 임시 저장 장치입니다.
   ::::::::: 답 ④ :::::::::